<!DOCTYPE html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>James Santos</title>
        <meta name="description" content="Personal site of James Santos">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="assets/landing.css" rel="stylesheet" type="text/css">
    </head>
    <body>
        <h1 class="hello">
            <span class="text-wrapper">
                <span class="line line1 blinking"></span>
                <span class="letters letters1">hi there</span>
            </span>
            <span class="text-wrapper">
                <span class="line line2"></span>
                <span class="letters letters2">I'm James</span>
            </span>
        </h1>
          
        <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/2.0.2/anime.min.js"></script>
        <script>
            var elements = document.querySelectorAll('.hello .letters1');
            Array.prototype.forEach.call(elements, function(el, i){
                el.innerHTML = el.textContent.replace(/([^\x00-\x80]|\w|\!|\')/g, "<span class='letter'>$&</span>");
            });

            var elements = document.querySelectorAll('.hello .letters2');
            Array.prototype.forEach.call(elements, function(el, i){
                el.innerHTML = el.textContent.replace(/([^\x00-\x80]|\w|\!|\')/g, "<span class='letter'>$&</span>");
            });

            var letters1 = document.querySelector('.hello .letters1')
            var letters2 = document.querySelector('.hello .letters2');
            
            setTimeout(() => {
                var line1 = document.querySelector('.hello .line1');
                line1.classList.remove('blinking');

                var letters1Promise = anime.timeline({loop: false})
                .add({
                    targets: '.hello .line1',
                    translateX: [0,letters1.offsetWidth],
                    easing: "linear",
                    duration: 200
                })
                .add({
                    targets: '.letters1 .letter',
                    opacity: [0,1],
                    easing: "easeOutExpo",
                    duration: 200,
                    offset: '-=' + letters1.offsetWidth,
                    delay: function(el, i) {
                        return 25 * (i+1)
                    }
                });
                    
                var afterLetters1 = letters1Promise.children[letters1Promise.children.length - 2];

                afterLetters1.finished.then(function () {
                    var line1 = document.querySelector('.hello .line1');
                    line1.classList.add('blinking');

                    var letters2Promise = anime.timeline({loop: false})
                    .add({
                        targets: '.hello .line1',
                        opacity: [1,0.0],
                        easing: "easeOutExpo",
                        duration: 10,
                        delay: 1250
                    })
                    .add({
                        targets: '.hello .line2',
                        opacity: [0.0,1],
                        duration: 10,
                        delay: 100
                    })
                    .add({
                        targets: '.hello .line2',
                        translateX: [0,letters2.offsetWidth],
                        easing: "linear",
                        duration: 250,
                        delay: 100
                    })
                    .add({
                        targets: '.letters2 .letter',
                        opacity: [0,1],
                        easing: "easeOutExpo",
                        duration: 200,
                        offset: '-=244',
                        delay: function(el, i) {
                            return 25 * (i+1)
                        }
                    });

                    var afterLetters2 = letters2Promise.children[letters2Promise.children.length - 2]
                    afterLetters2.finished.then(function () {
                        var line2 = document.querySelector('.hello .line2');
                        line2.classList.add('blinking');
                    });
                });
            }, 1250);
        </script>
    </body>
</html>